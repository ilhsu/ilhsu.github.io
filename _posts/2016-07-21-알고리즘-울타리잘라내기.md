---
layout: post
title: (알고리즘 문제) 울타리 잘라내기 - 난이도(중)
---

너비가 같고 높이가 다른 판자가 나란히 서있을 때, 울타리의 일부를 직사각형으로 잘라내고 싶습니다. 잘라낼 수 있는 직사각형의 최대 크기를 계산하는 프로그램을 작성하세요. 단, 직사각형을 비스듬히 잘라낼 수는 없습니다. 판자의 너비는 모두 1이라고 가정합니다.

#### 입력
첫 줄에 테스트 케이스의 개수 C(C<=50)가 주어집니다. 각 테스트 케이스의 첫 줄에는 판자의 수 N(1<=N<=20000)이 주어집니다. 그 다음 줄에는 N개의 정수로 왼쪽부터 각 판자의 높이가 순서대로 주어집니다. 높이는 모두 10000 이하의 자연수입니다.

#### 출력
각 테스트 케이스당 최대 직사각형의 크기를 나타내는 정수를 한 줄에 출력합니다.

#### 예제 입력
````
3
7
7 1 5 9 6 7 3
7
1 4 4 4 4 1 1
4
1 8 2 2
````

#### 예제 출력
````
20
16
8
````

### 풀이 - 언어: javascript
울타리를 절반씩 계속 나눈 다음 각 영역에서의 직사각형 최대값을 구해서 합쳐나는 분할 정복 방식을 사용해야겠다는 생각은 직관적으로 들었다. 기저 사례는 당연히 판자가 하나만 존재할때는 해당 판자의 높이 값을 리턴하면 될 터였다.

문제는 두 울타리 영역을 하나로 합쳐나갈 때 최대 직사각형이 각 영역에 걸쳐서 있는 경우를 어떻게 처리해야 할지가 어려웠다. 한참을 고민끝에 결국에는 해답 행.

먼저 생각해낸 방향은 맞았고, 마지막 영역 중간의 걸쳐진 부분 처리가 문제였는데 그 부분은 일괄 탐색 방법으로 찾아내는게 해답이였다. 키 포인트는 양 영역에 걸쳐있는 직사각형은 무조건 영역에 맞닿아 있는 판자 두 개를 포함한다는 거고, 거기서부터 좌우로 더 높은 판자가 있는 쪽으로 한 칸씩 확장해 나가면서 max 값을 찾아낸다.

풀이의 방법대로 구현했을 때, 복잡도는 `nlgn`으로 Merge Sort 와 같은 시간 복잡도를 가진다.

#### 배운 점들
- 부분 문제를 합치거나 나누는 과정에서 일괄 탐색 방법을 적용해 쓰기도 한다.
- 배열 Index의 중간 값은 `Math.floor`를 사용해 구하는게 좋다. `Math.round`는 결과를 반올림 해버리므로 중간에서 벗어난 값이 나오기 쉽다.

#### 풀이 코드
````javascript
'use strict';

function solve(left, right) {
    // 기저 사례
    if (left === right)
        return fence[left];
    
    let mid = Math.floor((left + right) / 2);
    let lo = mid, hi = mid + 1;
    // 각개 격파
    let ret = Math.max(solve(left, lo), solve(hi, right));

    let height = Math.min(fence[lo], fence[hi]);

    // 중앙에 걸쳐있는 너비 2인 사각형 고려
    ret = Math.max(ret, height * 2);
    
    // 중앙에 걸친 사각형이 구간 전체를 덮을때까지 한칸씩 확장
    while (lo > left || hi < right) {
        if (hi < right && (lo === left || fence[hi+1] > fence[lo - 1])) {
            ++hi;
            height = Math.min(height, fence[hi]);
        } else {
            --lo;
            height = Math.min(height, fence[lo]);
        }
        
        ret = Math.max(ret, height * (hi - lo + 1));
    }

    return ret;
}

//let fence = [7, 1, 5, 9, 6, 7, 3];
//let fence = [1, 4, 4, 4, 4, 1, 1];
let fence = [1, 8, 2, 2];
console.log(solve(0, fence.length - 1));
````